เมื่อเร็วๆ นี้ Ivica เพิ่งได้งานรับ-ส่งพิซซ่าของร้านขายพิซซ่าชื่อดังในเมือง <br />
ในวันแรกของการทำงานของเขา เขาได้รับใบรายชื่อของตำแหน่งที่เขาต้องไปส่งพิซซ่าให้ ซึ่งเรียงกันตามลำดับที่เขาจะต้องไปส่งแล้ว<br />
เมืองนี้จะถูกแบ่งเป็นเซลล์ขนาด R&times;C เซลล์ ซึ่งจะนับแถวจาก 1 ถึง R และนับคอลัมน์จาก 1 ถึง C<br />
ในทุก ๆ เซลล์ สามารถเคลื่อนที่ไปทางซ้ายหรือขวาไปยังเซลล์ข้างเคียงได้ ส่วนการเคลื่อนที่ขึ้น-ลงจะทำได้ก็ต่อเมื่ออยู่ในคอลัมน์แรกและคอลัมน์สุดท้ายเท่านั้น (นั่นคือ คอลัมน์ 1 และคอลัมน์ C)<br />
ร้านขายพิซซ่าจะอยู่มุมบนซ้ายสุดของเซลล์ หรือคือช่อง (1, 1) และนี่ก็คือตำแหน่งที่ Ivica ใช้ในการเริ่มต้นส่งพิซซ่า Ivica จะนำพิซซ่าทั้งหมดที่เขาจะต้องไปส่งในวันนั้นติดตัวไปกับเขาด้วย ดังนั้น เขาจึงไม่ต้องย้อนกลับมาที่ร้านพิซซ่าในระหว่างการส่งของหรือหลังจากการส่งพิซซ่าครั้งสุดท้ายเสร็จสิ้น<br />
สำหรับทุกตำแหน่งที่อยู่ในเมือง Ivica จะรู้เวลาทั้งหมดที่เขาต้องใช้ ทุกเวลาที่เขาต้องอยู่ในตำแหน่งนั้น ๆ (ให้มองผ่านเวลาที่คาบเกี่ยวกัน ดังเช่นในตัวอย่าง)<br />
<br />
<strong><u>งานของคุณ<br />
</u></strong><br />
จงเขียนโปรแกรมเพื่อคำนวณหาเวลาที่น้อยที่สุดที่ Ivica ต้องใช้ในการส่งพิซซ่าทั้งหมด<br />
<br />
<u><strong>ข้อมูลนำเข้า</strong></u><br />
<br />
ในบรรทัดแรก ประกอบด้วยเลขจำนวนเต็ม R และ C ของขนาดเมือง ซึ่งมีค่าดังนี้ 1 &le; R &le; 2000, 1 &le; C &le; 200<br />
ในแต่ละ R บรรทัดถัดมา คือเลขจำนวนเต็ม C ค่าเพื่อแสดงเวลาทั้งหมดที่ Ivica ต้องใช้ในแต่ละตำแหน่งซึ่งเวลาเหล่านี้จะต้องเป็นเลขจำนวนเต็มที่มีค่าตั้งแต่ 0 ถึง 5000<br />
บรรทัดถัดมา คือเลขจำนวนเต็มของจำนวนพิซซ่าทั้งหมดที่จะต้องส่งในวันนั้น ๆ (D) ซึ่งมีค่าดังนี้ 1 &le; D &le; 200000 <br />
แต่ละ D บรรทัดถัดมา คือเลขจำนวนเต็ม 2 ค่าคือ A และ B แสดงตำแหน่งที่จะต้องไปส่งพิซซ่า ซึ่งมีค่าดังนี้ 1 &le; A &le; R, 1 &le; B &le; C โดยได้เรียงลำดับของพิซซ่าที่จะต้องไปส่งแล้วและไม่มีการส่งพิซซ่าที่ตำแหน่งเดียวกันซ้ำกัน <br />
<br />
<u><strong>ข้อมูลส่งออก</strong></u><br />
<br />
ให้แสดงผลปริมาณเวลาที่น้อยที่สุดที่ Ivica ต้องใช้ในการส่งพิซซ่าทั้งหมด <br />
<br />
<strong><u>การให้คะแนน</u></strong><br />
<br />
ในกรณีทดสอบ จะได้รับ 70% ของคะแนนทั้งหมด ถ้า R มีค่ามากที่สุดที่ 250<br />
<br />
<u><strong>ที่มา:</strong></u> COCI 2008/2009, Contest #6 &ndash; March 7, 2009<br />
<br />
<strong>ในตัวอย่างที่ 1</strong> เส้นทางที่ใช้เวลาน้อยที่สุด คือการเคลื่อนที่จาก (1, 1), (2, 1), (3, 1), (3, 2), (3, 3), (2, 3), (1, 3), (2, 3), (3, 3), (2, 3) และ (2, 2) ตำแหน่งที่เป็นแถบหนา คือตำแหน่งที่ Ivica ทำการส่งพิซซ่า<br />
เวลาทั้งหมดที่ต้องใช้ในการส่งคือ 1+2+1+0+1+2+2+2+1+2+3 = 17<br />
		<table>
			<tr>
				<th>ข้อมูลนำเข้า</th>
				<th>ข้อมูลส่งออก</th>
			</tr>	
		
			<tr>
				<td>3 3
<br />1 8 2
<br />2 3 2
<br />1 0 1
<br />3
<br />1 3
<br />3 3
<br />2 2</td>
				<td>17</td>
			</tr>
			<tr>
				<td>2 5
<br />0 0 0 0 0
<br />1 4 2 3 2
<br />4
<br />1 5
<br />2 2
<br />2 5
<br />2 1</td>
				<td>9</td>
			</tr></table>
