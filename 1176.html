ลิงน้อยชื่อ &quot;ต๋อย&quot; อาศัยอยู่ ณ อุทยานแห่งชาติผาแต้มซึ่งเป็นอุทยานที่มีผืนป่าอุดมสมบูรณ์ที่สุดผืนหนึ่ง ท่านเทพารักษ์ประจำอุทยานต้องการทดสอบสติปัญญาของลิงต๋อย จึงสร้างปริศนาที่มีเสาวิเศษ จำนวน n ต้น และเสาแต่ละต้นสูง m เมตร เสาวิเศษทั้งหมดตั้งเรียงกันเป็นแนวเ้นตรง โดยแต่ละต้นมีหมายเลขประจำเสาคือ 1, 2, 3, ..., n-1, n เขียนกำดับตามลำดับ (ดังตัวอย่าง) เสาทั้งหมดมีระยะห่างระหว่างต้นเท่ากน และบนยอดเสาวิเศษแต่ละต้นมีกล้วยทิพย์อยู่จำนวนต่างกัน<br />
<div style="text-align: center;"><img src="http://i.imgur.com/ufr1zFs.png" width="250" height="168" alt="" /></div>
ท่าเทพารักษ์สามารถเสกกิ่งไม้มาเชื่อมระหว่างเสาวิเศษสองต้นที่อยู่ติดกันในแนวนอน (หรือแนวระดับ) เป็นจำนวน k กิ่งได้ โดยเสาวิเศษที่อยู่ติดกันหมายถึง เสาวิเศษต้นที่ 1 อยู่ติดกับส้ตที่ 2, เสาวิเศษต้นที่ n อยู่ติดกับต้นที่ n-1 และเสาวิเศษต้นที่ i อยู่ติดกับต้นที่ i-1 และ ต้นที่ i+1 เมื่อ i = 2, 3, ..., n-1 และตั้งกฎไว้ว่า จะไม่มีกิ่งไม้เชื่อมที่ฐานของเสาวิเศษ (ความสูง 0 เมตร) และยอดเสาวิเศษ (ความสูง m เมตร) กิ่งไม้เชื่อมที่ระดับความสูงเดียวกันจะไม่อยู่ติดกัน ตัวอย่างเช่น ถ้ามีกิ่งไม้เชื่อมระหว่างเสาวิเศษต้นที่ 1 กับเสาวิเศษต้นที่ 2 ที่ระดับความสูง 5 เมตร จะไม่มีกิ่งไม้เชื่อมระหว่างเสาวิเศษต้นที่ 2 กับเสาวิเศษต้นที่ 3 ที่ระดับความสูง 5 เมตร<br />
<br />
ทั้งที่ระหว่างเสาวิเศษที่อยู่ติดกันสองเสาใดๆ อาจจะมีกิ่งไม้เชื่อมได้ในหลายระดับความสูง หรืออาจจะไม่มีกิ่ไม้เชื่อมเลยก็ได้ ดังตัวอย่าง
<div style="text-align: center;"><img src="http://i.imgur.com/KI2cJLx.png" width="150" height="182" alt="" /></div>
ท่านเทพารักษ์ตั้งเงื่อนไขให้ลิงต๋อยปีนขึ้นเสาวิเศษต้นที่กำหนด เพื่อเก็บกล้วยทิพย์บนยอดเสา โดยลิงต๋อยสามารถปีนขึ้นได้เพียงอย่างเดียว ไม่สามารถปีนลงได้ และจะปีนได้เพียงครั้งเดียวเท่านั้น ระหว่างปีนขึ้นถ้าลิงต๋อยพบกิ่งไม้เชื่อมลิงต๋อยจะถูกบังคับให้ไต่ตามกิ่งไม้เชื่อมนั้นไม่ยังเสาวิเศษอีกต้นที่เชื่อมอยู่เสมอ ตัวอย่างดังรูป
<div style="text-align: center;"><img src="http://i.imgur.com/IiSTr1K.png" width="500" height="199" alt="" /></div>
ยิ่งไปกว่านั้นท่านเทพารักษ์ได้มอบกิงไม้วิเศษ<strong>หนึ่งอัน </strong>แก่ลิงต๋อยสำหรับใช้เชื่อมเสาวิเศษต้นใดก็ได้ที่อยู่ติดกันที่ระดับความสูงใดก็ได้ตามที่ลิงต๋อยต้องการ เพื่อเป็น<strong>ส่วนหนึ่งของเส้นทาง </strong>ในการปีนไม่เก็บกล้วยทิพย์ให้ได้จำนวนมากที่สุด โดย<strong>ระดับความสูงของกิ่งเป็นทศนิยมได้</strong> และการเชื่อมต้องไม่ขัดแย้งกับกฎที่เทพารักษ์กำหนดไว้ก่อนหน้านี้ ทั้งนี้ลิงต๋อยไม่จำเป็นต้นใช้กิงไม้เศษนี้ก็ได้ รูปต่อไปแสดงคำตอบที่ดีดีสุดในแต่ละกรณี
<div style="text-align: center;"><img src="http://i.imgur.com/vq0NdBT.png" width="570" height="215" alt="" /></div>
<div style="text-align: left;">&nbsp;</div>
ด้วยความที่ผู้รู้วัยเยาว์ที่มารวมตัวกันในการแข่งขันคอมพิวเตอร์โอลิมปิกระดับชาติ ครั้ง 10 ณ มหาวิทยาลัยอุบลราชธานีเป็นผู้โอบอ้อมอารีต่อสัตว์โลก ไม่อาจนิ่งดูดายให้ลิงน้อยได้กล้วยทิพย์จำนวนน้อยกว่าที่ควรจะเป็นจึงอยากให้ผู้รู้วัยเยาว์ช่วยเขียนโปรแกรมเพื่อหาว่าเจ้าลิงต๋อยจะสามารถเก็บกล้วยทิพย์ได้จำนวนมากที่สุดที่เป็นไปได้เท่าใด เมื่อท่านเทพารักษ์กำหนดเสาวิเศษที่จะให้ลิงต๋อยเริ่มปีน และการปีนเป็นไปตามเงื่อนไขข้างต้น<br />
<br />
<strong>งานของคุณ</strong><br />
จงเขียนโปรแกรมคอมพิวเตอร์ที่มีประสิทธิภาพ เพื่อหาจำนวนกล้วยทิพย์ที่มากที่สุดที่ลิงต๋อยจะสามารถเก็บได้ พร้อมระบุว่ามีการใช้กิ่งไม้วิเศษในเส้นทางการปีนไปเก็บกล้วยทิพย์หรือไม่<br />
<br />
<strong>ข้อมูลนำเข้า</strong><br />
มีจำนวน k+3 บรรทัด ดังนี้<br />
บรรทัดแรก: ประกอบด้วยจำนวนเต็ม m, n, และ k แสดงความสูงของเสาวิเศษ จำนวนเสาวิเศษ และจำนวนกิ่งไม้ทั้งหมดตามลำดับ โดย 10 &lt;= m &lt;= 100,000, &nbsp;3 &lt;= n &lt;= 200,000, และ 0 &lt;= k &lt;= 1,000,000<br />
บรรทัดที่ 2: ประกอบด้วยจำนวน<strong>เต็มบวก</strong> n จำนวนระบุจำนวนกล้วยทิพย์ในยอดเสาต้นที่ 1 ถึงต้นที่ n ตามลำดับ และจำนวนกล้วยทิพย์มีค่าไม่เกิน 100,000,000<br />
บรรทัดที่ 3 ถึง k+2: แต่ละบรรทัดประกอบด้วยจำนวนเต็มสองจำนวน แต่ละจำนวนถูกคั่นด้วยช่องว่างหนึ่งช่อง แสดงข้อมูงของกิ่งไม้เชื่อที่ i ว่าเชื่อมเสาวิเศษหมายเลข p<sub>i</sub> กับ p<sub>i</sub>+1 ณ ระดับความสูง h<sub>i</sub> จำนวนแรกคือหมายเลขเสาวิเศษ&nbsp;p<sub>i</sub>&nbsp;และจำนวนที่สองคือระดับความสูง h<sub>i</sub>&nbsp;<br />
บรรทัดที่ k+3: เป็นจำนวนเต็มหนึ่งตัว ระบุหมายเลขเสาวิเศษที่ท่าเทพารักษ์กำหนดให้ลิงต๋อยเริ่มปีน โดยีค่าได้ตั้งแต่ 1 ถึง n<br />
<br />
<strong>ข้อมูลส่งออก</strong><br />
มีสองบรรทัด บรรทัดแรกระบุจำนวนกล้วยทิพย์ที่มากที่สุดที่ลิงต๋อยสามารถเก็บได้ บรรทัดที่สองระบุว่าลิงต๋อยได้ใช้กิ่งไม้วิเศษหรือไม่ โดยระบุว่า &quot;USE&quot; ในกรณีที่ใช้ ระบุว่า &quot;NO&quot; ในกรณีที่ไม่ใช้<br />
<br />
<br />
<em>ที่มา: การแข่งขันคอมพิวเตอร์โอลิมปิกระดับชาติ ครั้งที่ 10</em><br />
<div class="page" title="Page 1">
<div class="layoutArea">
<div class="column">&nbsp;</div>
</div>
</div>
		<table>
			<tr>
				<th>ข้อมูลนำเข้า</th>
				<th>ข้อมูลส่งออก</th>
			</tr>	
		
			<tr>
				<td>20 5 6<br />7 5 3 9 4<br />1 5<br />1 6<br />2 10<br />1 12<br />3 6<br />3 13<br />1</td>
				<td>9<br />USE</td>
			</tr>
			<tr>
				<td>40 5 4<br />100 150 115 130 90<br />1 10<br />2 15<br />4 20<br />3 25<br />3</td>
				<td>150<br />NO</td>
			</tr></table>